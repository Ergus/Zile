#	$Id: Makefile.in,v 1.3 2003/05/06 22:28:41 rrt Exp $

srcdir = @srcdir@
VPATH = $(srcdir)

DESTDIR =
prefix = @prefix@

etcdir = $(prefix)/share/zile

INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
INSTALL = @INSTALL@

CC = @CC@
CFLAGS = @CFLAGS@
LDFLAGS = @LDFLAGS@
ZILELIBS = ../lib/libzile.a
LIBS = $(ZILELIBS) @LIBS@

FILES = $(srcdir)/zilerc.sample $(srcdir)/FAQ $(srcdir)/HELP \
	$(srcdir)/MINIHELP1 $(srcdir)/MINIHELP2 $(srcdir)/MINIHELP3 \
	$(srcdir)/LATEST_VERSION $(srcdir)/TUTORIAL AUTODOC

AUTODOCSRCS = $(srcdir)/../src/*.c

.SUFFIXES:
.SUFFIXES: .c .o
.c.o:
	$(CC) -c -I. -I.. -I$(srcdir)/../lib -I$(srcdir)/../src $(CFLAGS) $<

all: $(FILES)

$(srcdir)/HELP: ../doc/zile.texi ../doc/zilerc.texi
	echo "**********************************************************" >$(srcdir)/HELP
	echo "Please consider reading the Texinfo version of this manual" >>$(srcdir)/HELP
	echo "(from the command line type \`info zile')." >>$(srcdir)/HELP
	echo "**********************************************************" >>$(srcdir)/HELP
	echo "" >>$(srcdir)/HELP
	makeinfo --no-header --no-split -I$(srcdir)/../doc $(srcdir)/../doc/zile.texi >>$(srcdir)/HELP

AUTODOC: $(AUTODOCSRCS) mkdoc
	./mkdoc $(AUTODOCSRCS) >AUTODOC

mkdoc: mkdoc.o
	$(CC) $(LDFLAGS) -o mkdoc mkdoc.o $(ZILELIBS)

refcard.ps: refcard.tex
	latex refcard
	dvips -o refcard.ps -ta4 -tlandscape refcard.dvi

.PHONY: install uninstall clean realclean distclean mostlyclean

install: all
	${srcdir}/../mkinsdir.sh $(DESTDIR)$(etcdir)
	for f in $(FILES); do \
		$(INSTALL_DATA) $$f $(DESTDIR)$(etcdir); \
	done

uninstall:
	for f in $(FILES); do \
		rm -f $(DESTDIR)$(etcdir)/`basename $$f`; \
	done

clean: 
	-rm -f mkdoc AUTODOC *.o

distclean: clean 
	-rm -f Makefile

realclean: distclean
	-rm -f HELP

mostlyclean: clean

mkdoc.o: $(srcdir)/../src/tbl_funcs.h $(srcdir)/../src/tbl_vars.h ../config.h
